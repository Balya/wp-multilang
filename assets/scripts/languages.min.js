(function(b){function a(c){if(!c.id){return c.text}return b('<img src="'+b(c.element).data("flag")+'" /> '+c.text+"</span>")}b(function(){b(document).on("click",".delete-language",function(){var c=b(this);if(confirm(wpm_languages_params.confirm_question)){var d={action:"wpm_delete_lang",language:c.data("language"),security:wpm_languages_params.delete_lang_nonce};b.ajax({url:wpm_languages_params.ajax_url,type:"post",data:d,dataType:"json",complete:function(){c.parent().parents(".postbox").fadeOut("slow",function(){b(this).remove();b(".language-order").each(function(e){b(this).text(e+1)});wpm_lang_count--})},error:function(g,e,f){alert(f+"\r\n"+g.statusText+"\r\n"+g.responseText)}})}});b("#wpm-languages").sortable({update:function(){b(".language-order").each(function(c){b(this).text(c+1)})}});b("#add_lang").click(function(){var c=wp.template("wpm-add-lang");var d={count:wpm_lang_count};b("#wpm-languages").append(c(d));b(".wpm-flags").trigger("init_select2");wpm_lang_count++});b(document).on("click",".handlediv",function(){b(this).parent().toggleClass("closed")});b(document).on("keypress, keyup",'.postbox input[name$="[name]"]',function(){var c=b(this).val();b(this).parents(".postbox").find("h2 .language-order+span").text(c)});b("#wpm_installed_localizations").on("init_localizations",function(){if(b(this).val()){b("#delete_localization").prop("disabled",false)}else{b("#delete_localization").prop("disabled",true)}});b("#delete_localization").click(function(){if(confirm(wpm_languages_params.confirm_question)){var c=b("#wpm_installed_localizations").val();var d=b(this);var e={action:"wpm_delete_localization",locale:c,security:wpm_languages_params.delete_localization_nonce};b.ajax({url:wpm_languages_params.ajax_url,type:"post",data:e,dataType:"json",beforeSend:function(){d.prop("disabled",true).after('<span class="spinner is-active"></span>')},success:function(f){d.next().remove();d.after('<span class="success">'+f+"</span>");b('#wpm_installed_localizations option[value="'+c+'"]').remove();b("#wpm_installed_localizations").trigger("init_localizations")},error:function(h,f,g){alert(g+"\r\n"+h.statusText+"\r\n"+h.responseText)}})}});b(document).on("init_select2",".wpm-flags",function(){b(this).select2({templateResult:a,templateSelection:a})});b(".wpm-flags").trigger("init_select2")})}(jQuery));