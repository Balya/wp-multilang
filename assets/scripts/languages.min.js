(function(b){function a(c){if(!c.id){return c.text}return b('<img src="'+b(c.element).data("flag")+'" /> '+c.text+"</span>")}b(function(){b(document).on("click",".delete-language",function(){var c=b(this);if(confirm(wpm_languages_params.confirm_question)){var d={action:"wpm_delete_lang",language:c.data("language"),security:wpm_languages_params.delete_lang_nonce};b.ajax({url:wpm_languages_params.ajax_url,type:"post",data:d,dataType:"json",complete:function(){c.parent().parents(".postbox").fadeOut("slow",function(){b(this).remove();b(".language-order").each(function(e){b(this).text(e+1)});wpm_lang_count--})},error:function(g,e,f){alert(f+"\r\n"+g.statusText+"\r\n"+g.responseText)}})}});b("#wpm-languages").sortable({update:function(){b(".language-order").each(function(c){b(this).text(c+1)})}});b("#add_lang").click(function(){var c=wp.template("wpm-add-lang");var d={count:wpm_lang_count};b("#wpm-languages").append(c(d));b(".wpm-flags").trigger("change");wpm_lang_count++});b(document).on("click",".handlediv",function(){b(this).parent().toggleClass("closed")});b(document).on("keypress, keyup",'.postbox input[name$="[name]"]',function(){var c=b(this).val();b(this).parents(".postbox").find("h2 .language-order+span").text(c)});b("#wpm_installed_localizations").change(function(){if(b(this).val()){b("#delete_localization").prop("disabled",false)}else{b("#delete_localization").prop("disabled",true)}});b("#wpm_installed_localizations").trigger("change");b("#delete_localization").click(function(){if(confirm(wpm_languages_params.confirm_question)){var c=b("#wpm_installed_localizations").val();var d={action:"wpm_delete_translation",locale:c,security:wpm_languages_params.delete_localization_nonce};b.ajax({url:wpm_languages_params.ajax_url,type:"post",data:d,dataType:"json",success:function(){b('#wpm_installed_localization option[value="'+c+'"]').remove();b("#wpm_installed_localizations").trigger("change")},error:function(g,e,f){alert(f+"\r\n"+g.statusText+"\r\n"+g.responseText)}})}});b(document).on("change",".wpm-flags",function(){b(this).select2({templateResult:a,templateSelection:a})});b(".wpm-flags").trigger("change")})}(jQuery));